COSMICENERGY is a novel operational technology (OT) / industrial control system (ICS)-oriented malware designed to disrupt power by interacting with IEC 60870-5-104 (IEC-104) devices, such as remote terminal units (RTUs). 

This is similar to previous malware such as INDUSTROYER and INDUSTROYER.V2, which are known for their ability to disrupt power grids through the IEC-104 protocol

▪ Stage 1: Reconnaissance
Attackers are likely to conduct reconnaissance to identify potential targets and gather information regarding the target environment. 

This includes identifying MSSQL servers that have access to the OT network, MSSQL credentials, and target IEC-104 device IP addresses.

Attackers may also gather information about targeted assets, such as power-line switches, circuit breakers in an RTU, or relay configurations.


▪ Stage 2: Initial Access
Attackers gain initial access to the target environment, potentially through insecure methods such as exploiting vulnerabilities or using stolen credentials. 

In the case of COSMICENERGY, this may have involved connecting to a user-supplied remote MSSQL server.


▪ Stage 3: Launching an Actual Attack
Once attackers gain access to the target environment, they execute the COSMICENERGY malware. 

COSMICENERGY comprises two main components: PIEHOP and LIGHTWORK. PIEHOP, written in Python, connects to the MSSQL server to upload files, and issues remote commands to the RTU.


▪ Stage 4: Lateral Movement & Clearing Tracks
COSMICENERGY does not exhibit traditional lateral movement capabilities, because it lacks the ability to spread laterally within a network. 

However, internal reconnaissance is required to gather the information necessary for execution, indicating that attackers may have moved laterally within the network to gather this information.

After achieving their objectives, the attackers attempt to cover their tracks by deleting traces of malware and other malicious activities from the target environment.

This could include deleting the executable files of PIEHOP and LIGHTWORK from compromised systems.























